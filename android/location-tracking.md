---
id: location-tracking
title: مکان یابی
layout: android
permalink: android/location-tracking.html
prev: gradle-setup.html
next: manifest.html
---

## استفاده از شیء LocationManager
برای استفاده از امکانات مکان یابی چابک بایستی ابتدا از نمونه جاری کلاینت چابک، شیء locationManager را بگیرید:

```java
AdpPushClient client = ((PushApplication) getApplication()).getPushClient();
LocationManager locationManger = client.getLocationManager();
```

همه متدهای مورد نیاز برای بکارگیری امکانات مکان یابی در این شیء قرار دارد.

## درخواست شروع مکان یابی
برای شروع شما باید متد start را با پارامترهای مربوط که در ادامه توضیح داده می شود، صدا بزنید:

```java
public void start(OnLocationUpdateListener listener, LocationParams params, boolean startService , boolean singleUpdate)
```
## 1.OnLocationUpdateListener
پارامتر اول این متد یک Listener است به شکل زیر:

```java
public interface OnLocationUpdateListener {
    void onConnected(@Nullable Bundle bundle);
    void onLocationUpdated(Location location);
}
```

شما باید این اینترفیس را برای کلاس مورد نظر خود که قصد دریافت مکان را در آن دارید پیاده سازی نمایید.

# متد onConnected
وقتی کلاینت مکان‌یابی متصل شد، این متد فراخوانی خواهدشد
معمولا در اینجا می توانید مقداردهی های اولیه در نمایش را انجام دهید، مثلا با فراخوانی متد getLastLocation از شیء locationManager می توانید آخرین مکان ثبت شده را برای نمایش نقطه اولیه روی نقشه دریافت نمایید.

# متد onLocationUpdated
هربار که مکان براساس تنظیمات اولیه بروزرسانی شود، این متد فراخوانی شده و شیء Location شامل اطلاعات نقطه جغرافیایی مورد نظر را می دهد.

## 2.LocationParams
پارامتر دوم متد فوق یک شیء برای تنظیمات اولیه مکان یاب می باشد.
بعنوان مثال نمونه زیر یک شیء برای ست کردن دقت مکان یابی، حداقل تغییر مکان و زمان تناوب بروزرسانی مکان را ست می کند:
```java
LocationParams params = new Builder().setAccuracy(LocationAccuracy.HIGH).setDistance(0).setInterval(500).build();
```

# دقت مکان‌یابی
برای مقداردهی اولیه آن بایستی یکی از مقادیر enum ذیل را انتخاب نمایید:
```java
enum LocationAccuracy {
    HIGH,
    MEDIUM,
    LOW,
    LOWEST
}
```
مقادیر فوق گویای میزان دقت مکان‌یابی هستند،‌هرچقدر دقت مکان یابی بیشتر باشد، مکان گزارش شده با خطای کمتری خواهد بود، از دیگرسو دقت بیشتر مصرف باتری بیشتری نیز به دنبال خواهد داشد.

## HIGH
این مقدار را برای دریافت حداکثر دقت مکان بکار ببرید، بااین تنظیم سرویس مکان‌یابی با احتمال زیادی از GPS برای تشخیص مکان استفاده خواهد کرد.

## MEDIUM
این مقدار را برای دریافت دقت مکان‌یابی در یک بلاک شهری بکار ببرید، که دقتی در حدود تقریبی ۱۰۰ متر دارد، این مقدار، خطای نسبتا بزرگی درنظر گرفته می شود، و به احتمال زیاد باتری کمتری مصرف خواهد کرد. با این تنظیم سرویس مکان‌یابی به احتمال زیاد از Wifi‌ و دکل های مخابراتی برای مکان‌یابی استفاده خواهد کرد.

```code
نکته
انتخاب منبع دریافت مکان به فاکتورهای زیاد دیگری بستگی دارد، مثلا در دسترس بودن هر منبع، اگر به هر دلیلی منبع مورد نظر در دسترس نباشد، فاکتورها تغییر خواهد کرد.
```

## LOW
این مقدار را برای دریافت دقت مکان‌یابی درسطح شهر در نظر بگیرید، که دقتی در حدود ۱۰ کیلومتر می باشد. با توجه به این نوع دقت مصرف باتری کمتری خواهیم داشت.

## LOWEST
اگر مصرف باتری برایتان خیلی مهم است، ولی بروزرسانی مکان را فقط وقتی در دسترس باشد نیاز دارید، از این مقدار استفاده کنید.
با این تنظیم برنامه شما هیچ بروزرسانی مکان را درخواست نخواهد کرد،‌ولی درخواست بروزرسانی توسط برنامه های دیگر را دریافت خواهد نمود.

